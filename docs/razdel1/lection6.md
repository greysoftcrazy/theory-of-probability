## Лекция 6. Формулы Байеса и Бернулли

Пусть произведен эксперимент, в результате которого событие А наступило. 

Эта дополнительная информация позволяет произвести переоценку вероятностей гипотез $$H_i$$, вычислив $$Р(H|А)$$. По теореме произведения зависимых событий вероятность одновременного осуществления и события А, и гипотезы $$H_i$$ равна:

$$P(A· H_i) = Р(А) · Р(H_i|А) = Р(H_i) · Р(A|H_i)$$.      Откуда:  

$$Р(H_i|А) = {Р(H_i) · Р(A|H_i) \over P(A)}$$, вычислив $$Р(А)$$ по формуле полной вероятности получим:

$$Р(H_i|А) ={Р(H_i) · Р(A|H_i) \over {\textstyle\sum_{1}^n Р(H_i) · Р(A|H_i)}} $$

Эту формулу называют формулой Байеса (Бейеса). Формула Байеса позволяет переоценить вероятности гипотез после того, как становится известным результат испытания, в результате которого появилось событие А.

*Задача 1*. 

В двух группах занимаются соответственно 20 и 30 студентов. В первой группе 5 отличников, во второй 6. Какова вероятность того, что вызванный наугад студент оказался отличником? Вызванный наугад студент оказался отличником. Найти вероятность того, вызванный наугад студент оказался отличником из **первой** группы $$Р(H_1|А)$$.

*Решение*.

Вероятность $$Р(A|H_1)$$ события «вызван студент-отличник при условии, что он является отличником из первой группы». Аналогично вероятность $$Р(А|H_2)$$ из второй группы. По формуле Байеса получаем:

$$Р(H_1|А) = {Р(H_1) · Р(A|H_1) \over {P(H_1) · Р(A|H_1) + P(H_2) · Р(A|H_2)}} = { 0,4 · 0,25 \over {0,4 · 0,25 + 0,6 · 0,2}} ≈ 0,45$$

*Ответ*: 0,45

*Задача 2*.

Статистика запросов кредитов в банке такова: 10% - государственные органы, 30% - другие банки, остальное – физические лица. Вероятности невозврата кредита соответственно равны: 0,01; 0,05; 0,2. Найти вероятность невозврата очередного кредита. 

Начальнику кредитного отдела доложили, что получено сообщение о невозврате кредита, но имя клиента плохо пропечатано. Какова вероятность того,что кредит не возвращает другой банк?

*Решение*.

Вероятность невозврата найдем по формуле полной вероятности. Пусть $$H_1$$ означает, что запрос поступил от государственного органа, $$H_2$$ -от банка, $$H_3$$ - от физического лица и событие А – невозврат рассматриваемого кредита. 

Тогда 
$$ Р(А) = Р(H_1) · Р(А|H_11) + Р(H_2) · Р(А|H_2) + Р(H_3) · Р(А|H_3) =$$
 $$= 0,1·0,01 + 0,3·0,05 + 0,6·0,2 = 0,136$$.

Вероятность того, что данный кредит не возвращает другой банк, найдем по формуле Байеса: 

$$Р(H_2|А) = {P(H_2) · P(A|H_2) \over P(A)} ={0,015 \over 0,136} ≈ 0,11$$.

*Ответ*: 0,11


Чтобы ответить на вопрос: «Какова вероятность появления события ровно $$m$$ раз при $$n$$ испытаниях?» применяется **формула Бернулли**

$$ P_n^m = C_n^m · p^m · q^{n-m} $$

где  $$p$$ – вероятность появления события при одном испытании, 

$$q$$ - вероятность непоявления события при одном испытании.

Формула Бернулли справедлива только для тех независимых испытаний, в которых вероятность $$p$$ события A сохраняется постоянной.

*Задача 3*.

Вероятность того, что лампа перегорит после 1000 часов работы, равна 0,8.

* а)Какова вероятность того, что, проработав 1000 часов, три из пяти ламп будут продолжать гореть?
* б)Найти вероятность того, что из пяти ламп не менее трех будут гореть.

*Решение*.

* a) По условию задачи работа каждой лампы в течение 1000 часов – испытание, поэтому $$n = 5$$. Событие А – работа трех ламп происходит в трех испытаниях, т.е. $$m = 3$$. В одиночном испытании вероятность того, что лампа перегорит, равна $$р = 0,8$$, а вероятность того, что лампа будет гореть равна $$q = 1 – 0,8 = 0,2$$. По формуле Бернулли

$$Р(А) = P_5(3)= {5! \over 3!·2!} · 0,2^3 · 0,8^2 = 10 · 0,008 · 0,64 = 0,0512$$.



* б) Обозначим через В событие «из пяти ламп не менее трех будут гореть».
  
Условие «не менее трех будут гореть» означает, что могут гореть **или** три лампы (событие $$A_3$$ ), **или** четыре лампы (событие $$A_4$$), **или** пять ламп (событие $$A_5$$). Тогда по формуле сложения вероятностей несовместных событий имеем: $$Р(В) = Р(A_3) + Р(A_4) + Р(A_5)$$. 

Так как  вероятности каждого из этих событий находится по формуле Бернулли

$$Р(A_3) = P_5(3) = {5! \over {3!·2!} } · 0,2^3 · 0,8^2 = 10·0,008·0,64 = 0,0512$$

$$Р(A_4) = P_5(4) = {5! \over {4!·1!} } · 0,2^4 · 0,8^1 = 0,0064$$

$$Р(A_5) = P_5(5) = {5! \over {5!·0!} } · 0,2^5 · 0,8^0 = 0,00032$$

$$Р(В) = 0,0512+0,0064+0,00032 = 0,05792 ≈ 0,06$$

*Ответ*: 0,0512; 0,06



 Итак, применение формулы Бернулли предполагает выполнение ряда условий:
 * число опытов фиксировано и ограничено; 
 * опыты независимы;
 * результатом испытания может быть лишь один из двух взаимно исключающих исходов (успех или неуспех);
 * вероятность успеха в каждом опыте одна и та же.

Если число испытаний в Схеме Бернулли велико, то вычисление вероятностей по точной формуле становится затруднительным. Поэтому возникает задача замены точной формулы приближенными. 
Локальная теорема Муавра-Лапласа.
Если в п независимых испытаниях событие А происходит с постоянной вероятностью, которая не очень близка к 0 и 1, то при достаточно большом  количестве испытаний вероятность того, что событие А произойдет т раз, приближенно равна ≈ ,  где  ,  x=. Для функции составлена таблица ее значений, которая публикуется в справочной литературе (см. приложение 1).
Задача 4.
 Вероятность невозврата кредита заемщиком по договоренности составляет 2%. Какова вероятность того, что из 600 заемщиков не вернут кредит по договору 20 человек?
Решение.
Используем локальную формулу Муавра-Лапласа. При n=600; m=20; p=0,02; q=0,98 найдем 
    1) x=;
    2) найдем значение функции  для  по таблице приложения 1:   
    3) считаем искомую вероятность:
≈≈ ≈ 

Ответ:

Интегральная формула Лапласа.
Если в n независимых испытаниях событие А происходит с постоянной вероятностью p, которая отличается от 0 и1, то при достаточно большом значении n вероятность того, что частота m события А находится в интервале [], приближенно равна 
 ≈ Φ( Φ(, 
где  Φ(, причем =, =. Функция Φ( называется функцией (интегралом) Лапласа. Она принимает значения в интервале (-0,5;0,5) и Φ( ; т.е. она нечетная. Таблица значений функции Лапласа приведена в приложении 2.
Задача 5.
В каждом из 700 независимых испытаний на брак появление стандартной лампочки происходит с постоянной вероятностью 0,65. Найдите вероятность того, что при таких условиях появление бракованной лампочки произойдет чаще, чем в 230 испытаниях, но реже, чем в 270 случаях.
Решение.
 Пусть А – появление бракованной лампочки. По условию задачи n=700;  p=1-0,65=0,35; q=0,65. Применим интегральную формулу Лапласа:
===-1,19; ===1,98;
Значения функции Лапласа при x=-1,19 и x=1,98 возьмем из таблицы приложения 2
Φ(= Φ( Φ(=-0,383;
Φ(=  Φ(=0,476.
Искомая вероятность
 ≈ Φ( Φ(=0,476+0,383=0,859
Ответ: 0,859
