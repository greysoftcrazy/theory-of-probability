## Лекция 6 Формулы Байеса и Бернулли

Пусть произведен эксперимент, в результате которого событие А наступило. 

Эта дополнительная информация позволяет произвести переоценку вероятностей гипотез $$H_i$$, вычислив $$Р(H|А)$$. По теореме произведения зависимых событий вероятность одновременного осуществления и события А, и гипотезы $$H_i$$ равна:

$$P(A· H_i) = Р(А) · Р(H_i|А) = Р(H_i) · Р(A|H_i)$$.      Откуда:  

$$Р(H_i|А) = {Р(H_i) · Р(A|H_i) \over P(A)}$$, вычислив $$Р(А)$$ по формуле полной вероятности получим:

$$Р(H_i|А) ={Р(H_i) · Р(A|H_i) \over {\textstyle\sum_{1}^n Р(H_i) · Р(A|H_i)}} $$

Эту формулу называют формулой Байеса (Бейеса). Формула Байеса позволяет переоценить вероятности гипотез после того, как становится известным результат испытания, в результате которого появилось событие А.

*Задача 1*. 

В двух группах занимаются соответственно 20 и 30 студентов. В первой группе 5 отличников, во второй 6. Какова вероятность того, что вызванный наугад студент оказался отличником? Вызванный наугад студент оказался отличником. Найти вероятность того, вызванный наугад студент оказался отличником из **первой** группы $$Р(H_1|А)$$.

*Решение*.

Вероятность $$Р(A|H_1)$$ события «вызван студент-отличник при условии, что он является отличником из первой группы». Аналогично вероятность $$Р(А|H_2)$$ из второй группы. По формуле Байеса получаем:

$$Р(H_1|А) = {Р(H_1) · Р(A|H_1) \over {P(H_1) · Р(A|H_1) + P(H_2) · Р(A|H_2)}} = { 0,4 · 0,25 \over {0,4 · 0,25 + 0,6 · 0,2}} ≈ 0,45$$

*Ответ*: 0,45

*Задача 2*.

Статистика запросов кредитов в банке такова: 10% - государственные органы, 30% - другие банки, остальное – физические лица. Вероятности невозврата кредита соответственно равны: 0,01; 0,05; 0,2. Найти вероятность невозврата очередного кредита. 

Начальнику кредитного отдела доложили, что получено сообщение о невозврате кредита, но имя клиента плохо пропечатано. Какова вероятность того,что кредит не возвращает другой банк?

*Решение*.

Вероятность невозврата найдем по формуле полной вероятности. Пусть $$H_1$$ означает, что запрос поступил от государственного органа, $$H_2$$ -от банка, $$H_3$$ - от физического лица и событие А – невозврат рассматриваемого кредита. 

Тогда 
$$ Р(А) = Р(H_1) · Р(А|H_11) + Р(H_2) · Р(А|H_2) + Р(H_3) · Р(А|H_3) =$$
 $$= 0,1·0,01 + 0,3·0,05 + 0,6·0,2 = 0,136$$.

Вероятность того, что данный кредит не возвращает другой банк, найдем по формуле Байеса: 

$$Р(H_2|А) = {P(H_2) · P(A|H_2) \over P(A)} ={0,015 \over 0,136} ≈ 0,11$$.

*Ответ*: 0,11


Чтобы ответить на вопрос: «Какова вероятность появления события ровно $$m$$ раз при $$n$$ испытаниях?» применяется **формула Бернулли**

где  $$p$$ – вероятность появления события при одном испытании, 

$$q$$ - вероятность непоявления события при одном испытании.

Формула Бернулли справедлива только для тех независимых испытаний, в которых вероятность $$p$$ события A сохраняется постоянной.

*Задача 3*.

Вероятность того, что лампа перегорит после 1000 часов работы, равна 0,8.

* а)Какова вероятность того, что, проработав 1000 часов, три из пяти ламп будут продолжать гореть?
* б)Найти вероятность того, что из пяти ламп не менее трех будут гореть.

*Решение*.

* a) По условию задачи работа каждой лампы в течение 1000 часов – испытание, поэтому $$n = 5$$. Событие А – работа трех ламп происходит в трех испытаниях, т.е. $$m = 3$$. В одиночном испытании вероятность того, что лампа перегорит, равна $$р = 0,8$$, а вероятность того, что лампа будет гореть равна $$q = 1 – 0,8 = 0,2$$. По формуле Бернулли

$$Р(А) = P_5(3)= {5! \over 3!·2!} · 0,2^3 · 0,8^2 = 10 · 0,008 · 0,64 = 0,0512$$.



* б) Обозначим через В событие «из пяти ламп не менее трех будут гореть».
  
Условие «не менее трех будут гореть» означает, что могут гореть **или** три лампы (событие $$A_3$$ ), **или** четыре лампы (событие $$A_4$$), **или** пять ламп (событие $$A_5$$). Тогда по формуле сложения вероятностей несовместных событий имеем: $$Р(В) = Р(A_3) + Р(A_4) + Р(A_5)$$. 

Так как  вероятности каждого из этих событий находится по формуле Бернулли

$$Р(A_3) = P_5(3) = {5! \over {3!·2!} } · 0,2^3 · 0,8^2 = 10·0,008·0,64 = 0,0512$$

$$Р(A_4) = P_5(4) = {5! \over {4!·1!} } · 0,2^4 · 0,8^1 = 0,0064$$

$$Р(A_5) = P_5(5) = {5! \over {5!·0!} } · 0,2^5 · 0,8^0 = 0,00032$$

$$Р(В) = 0,0512+0,0064+0,00032 = 0,05792 ≈ 0,06$$

Ответ: 0,0512; 0,06



 Итак, применение формулы Бернулли предполагает выполнение ряда условий:
 * число опытов фиксировано и ограничено; 
 * опыты независимы;
 * результатом испытания может быть лишь один из двух взаимно исключающих исходов (успех или неуспех);
 * вероятность успеха в каждом опыте одна и та же.

